<h2><%= @spot.title %></h2>

<p><%= @spot.prefecture %><%= @spot.city %></p>

<p>
  <% if @spot.visited_day.nil? %>
    来訪日: 不明
  <% else %>
    来訪日: <%= @spot.visited_day.strftime("%Y年%-m月%-d日") %>
  <% end %>
</p>

<% if @spot.rate.nil? %>
  <p>無評価</p>
<% else %>
  <p id="star-rate-<%= @spot.id %>"></p>
  <script>
    $('#star-rate-<%= @spot.id %>').raty({
      size: 36,
      starOff: '<%= asset_path('star-off.png') %>',
      starOn: '<%= asset_path('star-on.png') %>',
      readOnly: true,
      score: <%= @spot.rate %>,
    });
  </script>
<% end %>

<%= attachment_image_tag @spot, :spot_image1, format: "jpeg", fallback: "noimage-1-760x460.png", size: "100x100" %>
<%= attachment_image_tag @spot, :spot_image2, format: "jpeg", fallback: "noimage-1-760x460.png", size: "100x100" %>
<%= attachment_image_tag @spot, :spot_image3, format: "jpeg", fallback: "noimage-1-760x460.png", size: "100x100" %>

<p>内容: <%= @spot.content %></p>

<% if @spot.user == current_user %>
  <%= link_to "編集する", edit_spot_path(@spot) %>
  <%= link_to "削除する", spot_path(@spot), method: :delete, "data-confirm" => "本当に削除しますか？" %>
<% end %>

<div>
  <h2>投稿者プロフィール</h2>
  <%= attachment_image_tag @user, :profile_image, format: "jpeg", fallback: "noimage-1-760x460.png", size: "100x100" %>
  <p>ニックネーム: <%= @user.nickname %></p>
  <p>性別: <%= @user.sex.to_s %></p>
  <p>年齢: <%= @user.age %>歳</p>
  <p>住所: <%= @user.prefecture %><%= @user.city %></p>
  <p>自己紹介: <%= @user.introduction %></p>
  <% if @spot.user_id != current_user.id %>
    <%= link_to "プロフィールを見る", user_path(@user) %>
  <% end %>
</div>

<div>
  <div>
    <h2>コメント</h2>
    <p>
      全<%= @spot.comments.count %>件
    </p>
    <% @spot.comments.each do |comment| %>
    <div>
      <%= attachment_image_tag comment.user, :profile_image, format: "jpeg", fallback: "noimage-1-760x460.png", size: "100x100" %>
      <%= link_to user_path(comment.user) do %>
        <%= comment.user.nickname %>
      <% end %>
      <%= comment.comment %>
      <%= comment.created_at.strftime("%Y年%-m月%-d日 %-H:%M") %>
      <% if comment.user_id == current_user.id %>
        <%= link_to "削除する", spot_comment_path(comment.spot, comment), method: :delete %>
      <% end %>
    </div>
    <% end %>
  </div>

  <div>
    <h3>コメントをどうぞ</h3>
    <%= form_with(model: [@spot, @comment], local: true) do |f| %>
      <%= f.text_area :comment, rows: '5' %>
      <%= f.submit "送信する" %>
    <% end %>
  </div>

</div>